@model User

@{
    ViewData["Title"] = "Home Page";
    
}

<head>
    <script type="text/javascript">
        var map =
            [
                "&\#1632;", "&\#1633;", "&\#1634;", "&\#1635;", "&\#1636;",
                "&\#1637;", "&\#1638;", "&\#1639;", "&\#1640;", "&\#1641;"
            ];

        function getArabicNumbers(str) {
            var newStr = "";

            str = String(str);

            for (i = 0; i < str.length; i++) {
                newStr += map[parseInt(str.charAt(i))];
            }

            return newStr;
        }
    </script>
</head>

<div class="text-center" dir="rtl">

    <div class="container mt-3">
        <div class="row">
            <h5 class="text-end text-info">
                اقرأ ما تيسر من القران
                <i class="bi bi-book"></i>
            </h5>
        </div>
        <div class="row">
            <p class="text-start text-secondary" id="verseNameAndNumber">
                @QuranHandler.ChapterName
                @QuranHandler.VerseID
            </p>
            <script type="text/javascript">
                window.onload = function () {
                    document.getElementById("verseNameAndNumber").innerHTML = "@QuranHandler.ChapterName " + getArabicNumbers(@QuranHandler.VerseID);
                }
            </script>
            <p class="text-center">
                @QuranHandler.SetAndGetVerse(Model.Preference.SurahId, Model.Preference.VerseId);
            </p>
        </div>
        <div class="row" dir="ltr">
            <div class="btn-group btn-group-sm" role="group">
                <a class="btn btn-outline-secondary" asp-controller="Home" asp-action="PreVerse">
                    السابق
                </a>
                <a class="btn btn-outline-primary" asp-controller="Home" asp-action="NextVerse">
                    التالي
                </a>
            </div>
        </div>
        <br />
        <br />
        <div class="row">
            <h5 class="text-end text-info">
                جدول المهام اليومية
                <i class="bi bi-table"></i>
            </h5>
        </div>
        <form class="row" dir="ltr" method="post" asp-controller="Home" asp-action="AddDailyTask">
            <p>
                <div class="col-8">
                    <div class="input-group" role="grid">
                        <button class="btn btn-sm btn-outline-primary" dir="rtl" type="submit">
                            اضافة
                            <i class="bi bi-plus-lg"></i>
                        </button>
                        <input class="form-control form-control-sm" dir="rtl" 
                        placeholder="ادخل الاسم" asp-for="TempData"/>
                    </div>
                </div>
                <div class="col-4">
                    @if (TempData["AddDailyTaskError"] != null)
                    {
                        <div class="alert alert-dismissible alert-danger small">
                            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                            <strong>لا يمكن انشاء مهمة بدون اسم</strong>
                        </div>
                    }
                </div>
            </p>
        </form>

        <div class="row">
            <table class="table table-striped table-bordered">
                <tr class="table-primary">
                    <th width="45%">
                        الاسم
                        <i class="bi bi-info-circle"></i>
                    </th>
                    <th width="11%">
                        المتبقي
                        <i class="bi bi-hourglass-split"></i>
                    </th>
                    <th width="13%">
                        خيارات
                        <i class="bi bi-gear"></i>
                    </th>
                </tr>
                @foreach (var obj in Model.DailyTasks) {
                    <tr>
                        <td>
                            @obj.Name
                        </td>
                        <td>
                            @(Math.Round(24 - (DateTime.Now - obj.CreatedDate).TotalHours, 2))
                            ساعة
                        </td>
                        <td>
                            <div class="btn-group" role="group" dir="ltr">
                                <a class="btn btn-sm btn-outline-success" 
                                asp-controller="Home" asp-action="RemoveDailyTask" asp-route-taskId="@obj.TaskID">
                                    <i class="bi bi-check2-square"></i>
                                </a>
                                <a class="btn btn-sm btn-outline-secondary"
                               asp-controller="Home" asp-action="DelayDailyTask" asp-route-taskId="@obj.TaskID">
                                    <i class="bi bi-stopwatch"></i>
                                </a>
                            </div>
                        </td>
                    </tr>
                }
            </table>
        </div>

        <div class="row mt-2">
            <h5 class="text-end text-info">
                السعرات اليومية
                <i class="bi bi-fire"></i>
            </h5>
        </div>
        <div class="row align-items-center" dir="ltr">
            <div class="justify-content-center d-flex flex-column col-2">
                <label class="text-start text-primary">
                    @Model.Preference.CurrentCalories
                </label>
            </div>
            @* <div class="justify-content-center d-flex flex-column col-10"> *@
            @*     <div class="progress"> *@
            @*         <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100" style="width: 75%;"></div> *@
            @*     </div> *@
            @* </div> *@
        </div>
        @* TODO: add javascript to save changes and change label value *@
        <div class="row">
            <div class="col-5 btn-group d-flex justify-content-center" role="group" dir="ltr">

                <a class="btn btn-outline-primary" dir="rtl" >
                    +450
                </a>
                <a class="btn btn-outline-primary" dir="rtl" >
                    +150
                </a>
                <a class="btn btn-outline-primary" dir="rtl" >
                    +50
                </a>
            </div>
            <div class="col-2 text-center d-flex justify-content-center">
                @* TODO add functionality *@
                <a class="btn text-info">
                    حفظ
                </a>
            </div>
            <div class="col-5 btn-group d-flex justify-content-center" role="group" dir="ltr">
                <a class="btn btn-outline-secondary" dir="rtl" >
                    -50
                </a>
                <a class="btn btn-outline-secondary" dir="rtl" >
                    -150
                </a>
                <a class="btn btn-outline-secondary" dir="rtl" >
                    -450
                </a>
            </div>

        </div>

    </div>

</div>
